<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Living Library | Book Preloved Website</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Lora:ital,wght@0,400;0,500;1,400&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --wood-shelf: #4E342E;
            --lamp-warm: rgba(255, 200, 100, 0.3);
        }

        body {
            background-color: #0c0b0a;
            color: #f5f5f5;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }

        .serif { font-family: 'Playfair Display', serif; }
        .lora { font-family: 'Lora', serif; }

        .room-bg {
            position: fixed;
            inset: 0;
            z-index: -1;
            background: radial-gradient(circle at 50% 0%, #1a1614 0%, #050505 100%);
        }

        .ambient-light {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100vw;
            height: 60vh;
            background: radial-gradient(circle at 50% 0%, var(--lamp-warm), transparent 70%);
            pointer-events: none;
            z-index: 10;
        }

        .shelf-container {
            position: relative;
            padding: 40px 0 100px 0;
            perspective: 1500px;
        }

        .shelf-plank {
            height: 30px;
            background: linear-gradient(to bottom, #5D4037, #3E2723);
            border-bottom: 8px solid #2d1d1a;
            box-shadow: 0 20px 40px rgba(0,0,0,0.8);
            width: 110%;
            margin-left: -5%;
            border-radius: 4px;
        }

        .book-spine {
            width: 45px;
            height: 240px;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            transform-origin: bottom center;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 4px 0 15px rgba(0,0,0,0.6);
            border-radius: 2px 4px 4px 2px;
        }

        .book-spine:hover {
            transform: translateZ(80px) translateY(-25px) rotateY(15deg);
            filter: brightness(1.2) contrast(1.1);
            z-index: 100;
        }

        .book-title-spine {
            writing-mode: vertical-rl;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 1px;
            color: rgba(255,255,255,0.9);
            text-transform: uppercase;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 24px;
        }

        .fade-in { animation: fadeIn 0.8s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #3E2723; border-radius: 10px; }
    </style>
</head>
<body>

    <audio id="snd-rain" loop><source src="https://www.soundjay.com/nature/rain-07.mp3" type="audio/mpeg"></audio>
    <audio id="snd-open"><source src="https://www.soundjay.com/misc/paper-flip-1.mp3" type="audio/mpeg"></audio>
    <audio id="snd-click"><source src="https://www.soundjay.com/button/button-16.mp3" type="audio/mpeg"></audio>

    <div class="room-bg"></div>
    <div class="ambient-light"></div>

    <nav class="fixed top-0 w-full z-[100] px-8 py-6 flex justify-between items-center transition-all" id="main-nav">
        <div class="flex items-center gap-3 cursor-pointer" onclick="navigate('home')">
            <div class="p-2 bg-amber-900/50 rounded-xl border border-amber-500/20">
                <i data-lucide="library" class="text-amber-400 w-6 h-6"></i>
            </div>
            <h1 class="serif text-2xl font-bold tracking-tight text-white">Living Library</h1>
        </div>

        <div class="flex items-center gap-8">
            <button onclick="toggleRain()" id="rain-toggle" class="flex items-center gap-2 text-[10px] uppercase font-bold text-blue-300/60 hover:text-blue-200 transition-all">
                <i data-lucide="cloud-drizzle" class="w-4 h-4"></i> <span id="rain-status">Nyalakan Hujan</span>
            </button>
            <div class="hidden md:flex gap-6 items-center">
                <button onclick="navigate('sell')" class="text-[10px] uppercase font-bold tracking-[0.2em] text-amber-200 hover:text-white transition-all">Titip Jual AI</button>
                <div class="relative cursor-pointer" onclick="navigate('cart')">
                    <i data-lucide="shopping-bag" class="w-5 h-5 text-white"></i>
                    <span id="cart-badge" class="absolute -top-2 -right-2 bg-amber-600 text-[8px] w-4 h-4 rounded-full flex items-center justify-center font-bold hidden">0</span>
                </div>
            </div>
        </div>
    </nav>

    <main id="app" class="relative z-30 pt-32 pb-24 px-6 max-w-7xl mx-auto">
        <!-- Rendered by JavaScript -->
    </main>

    <div id="modal-overlay" class="fixed inset-0 z-[200] hidden flex items-center justify-center p-4 bg-black/90 backdrop-blur-xl overflow-y-auto" onclick="if(event.target === this) closeModal()">
        <div id="modal-container" class="max-w-5xl w-full fade-in"></div>
    </div>

    <script>
        const apiKey = ""; 
        
        const BOOKS_DB = [
            { 
                id: 1, title: "Laskar Pelangi", author: "Andrea Hirata", price: 45000, color: "#1b3a27", category: "Sastra Indonesia",
                img: "https://images.unsplash.com/photo-1544947950-fa07a98d237f?auto=format&fit=crop&q=80&w=800",
                condition: "85% (Baik)", minus: "Kertas sedikit menguning di bagian pinggir, ada tanda tangan pemilik lama.", 
                address: "Gantong, Belitung Timur",
                desc: "Kisah inspiratif sepuluh anak Belitong dalam mengejar pendidikan."
            },
            { 
                id: 2, title: "Bumi Manusia", author: "Pramoedya Ananta Toer", price: 89000, color: "#5d1c1c", category: "Sastra Indonesia",
                img: "https://images.unsplash.com/photo-1512820790803-83ca734da794?auto=format&fit=crop&q=80&w=800",
                condition: "95% (Sangat Baik)", minus: "Tidak ada minus, plastik segel baru dibuka.", 
                address: "Senen, Jakarta Pusat",
                desc: "Mahakarya tentang perlawanan Minke terhadap ketidakadilan kolonial."
            },
            { 
                id: 3, title: "Cantik Itu Luka", author: "Eka Kurniawan", price: 72000, color: "#3e1c5d", category: "Fiksi",
                img: "https://images.unsplash.com/photo-1495446815901-a7297e633e8d?auto=format&fit=crop&q=80&w=800",
                condition: "80% (Cukup)", minus: "Cover ada sedikit tekukan di pojok bawah, halaman lengkap.", 
                address: "Cilacap, Jawa Tengah",
                desc: "Kisah tragis berbalut realisme magis tentang sejarah kelam nusantara."
            },
            { 
                id: 4, title: "Filosofi Teras", author: "Henry Manampiring", price: 55000, color: "#222222", category: "Self-Improvement",
                img: "https://images.unsplash.com/photo-1589998059171-988d887df646?auto=format&fit=crop&q=80&w=800",
                condition: "90% (Baik)", minus: "Ada highlight stabilo di 2 halaman awal.", 
                address: "Tangerang Selatan",
                desc: "Penerapan filsafat stoisisme dalam kehidupan modern."
            },
            { 
                id: 5, title: "Negeri 5 Menara", author: "A. Fuadi", price: 38000, color: "#1c3d5d", category: "Sastra Indonesia",
                img: "https://images.unsplash.com/photo-1541963463532-d68292c34b19?auto=format&fit=crop&q=80&w=800",
                condition: "75% (Cukup)", minus: "Beberapa halaman ada bercak air, tapi teks masih sangat jelas.", 
                address: "Maninjau, Sumatera Barat",
                desc: "Perjalanan mengejar mimpi di pondok madani."
            },
            { 
                id: 6, title: "Hujan", author: "Tere Liye", price: 42000, color: "#1c5d54", category: "Fiksi",
                img: "https://images.unsplash.com/photo-1531346878377-a5be20888e57?auto=format&fit=crop&q=80&w=800",
                condition: "98% (Seperti Baru)", minus: "Mulus total tanpa cacat.", 
                address: "Bandung, Jawa Barat",
                desc: "Tentang persahabatan, cinta, dan melupakan."
            }
        ];

        let cart = [];
        let isRainy = false;

        function playSound(id) {
            const s = document.getElementById(id);
            if(s) { s.currentTime = 0; s.play().catch(() => {}); }
        }

        function toggleRain() {
            const rain = document.getElementById('snd-rain');
            const status = document.getElementById('rain-status');
            isRainy = !isRainy;
            if(isRainy) {
                rain.play();
                status.innerText = "Matikan Hujan";
                document.body.style.filter = "contrast(1.1) brightness(0.9)";
            } else {
                rain.pause();
                status.innerText = "Nyalakan Hujan";
                document.body.style.filter = "none";
            }
            playSound('snd-click');
        }

        function navigate(page) {
            playSound('snd-click');
            const app = document.getElementById('app');
            app.style.opacity = '0';
            setTimeout(() => {
                if(page === 'home') renderHome();
                else if(page === 'sell') renderSell();
                else if(page === 'cart') renderCart();
                app.style.opacity = '1';
                lucide.createIcons();
                window.scrollTo(0,0);
            }, 300);
        }

        function renderHome() {
            const app = document.getElementById('app');
            const shelf1 = BOOKS_DB.slice(0, 3);
            const shelf2 = BOOKS_DB.slice(3, 6);

            app.innerHTML = `
                <div class="text-center mb-32 fade-in">
                    <span class="text-[10px] uppercase tracking-[0.6em] text-amber-500 mb-4 block">Est. 2024</span>
                    <h2 class="serif text-6xl md:text-8xl italic text-white leading-tight">Book Preloved<br>Website</h2>
                    <p class="lora text-white/40 mt-6 text-xl max-w-2xl mx-auto italic">Platform tepercaya untuk memberikan nafas kedua bagi buku-buku lama berkualitas.</p>
                </div>

                <div class="mb-32">
                    <h3 class="serif text-2xl mb-8 flex items-center gap-3">
                        <span class="w-10 h-px bg-amber-500/30"></span> Rak Koleksi Pilihan
                    </h3>
                    <div class="shelf-container">
                        <div class="flex justify-center gap-4 h-[240px] items-end px-12">
                            ${shelf1.map(b => `<div class="book-spine" style="background:${b.color}" onclick="openBook(${b.id})"><div class="book-title-spine">${b.title}</div></div>`).join('')}
                        </div>
                        <div class="shelf-plank"></div>
                    </div>
                </div>

                <div class="mb-40">
                    <h3 class="serif text-2xl mb-8 flex items-center gap-3 justify-end">
                        Rak Literatur Terbaru <span class="w-10 h-px bg-amber-500/30"></span>
                    </h3>
                    <div class="shelf-container">
                        <div class="flex justify-center gap-4 h-[240px] items-end px-12">
                            ${shelf2.map(b => `<div class="book-spine" style="background:${b.color}" onclick="openBook(${b.id})"><div class="book-title-spine">${b.title}</div></div>`).join('')}
                        </div>
                        <div class="shelf-plank"></div>
                    </div>
                </div>

                <div class="grid md:grid-cols-3 gap-8 mb-40">
                    <div class="glass-card p-10 text-center group hover:bg-white/5 transition-all">
                        <div class="w-16 h-16 bg-amber-500/10 rounded-full flex items-center justify-center mx-auto mb-6 text-amber-50 group-hover:scale-110 transition-transform">
                            <i data-lucide="shield-check"></i>
                        </div>
                        <h4 class="serif text-2xl mb-4">Terverifikasi</h4>
                        <p class="text-sm text-white/40 leading-relaxed">Pengecekan fisik manual oleh tim kurator untuk menjamin kondisi sesuai deskripsi.</p>
                    </div>
                    <div class="glass-card p-10 text-center group hover:bg-white/5 transition-all">
                        <div class="w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center mx-auto mb-6 text-blue-400 group-hover:scale-110 transition-transform">
                            <i data-lucide="package"></i>
                        </div>
                        <h4 class="serif text-2xl mb-4">Pengemasan Premium</h4>
                        <p class="text-sm text-white/40 leading-relaxed">Perlindungan ekstra bubble wrap dan dus kaku tanpa biaya tambahan.</p>
                    </div>
                    <div class="glass-card p-10 text-center group hover:bg-white/5 transition-all">
                        <div class="w-16 h-16 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-6 text-green-400 group-hover:scale-110 transition-transform">
                            <i data-lucide="award"></i>
                        </div>
                        <h4 class="serif text-2xl mb-4">Trusted Seller</h4>
                        <p class="text-sm text-white/40 leading-relaxed">Telah melayani ribuan pembaca setia di seluruh pelosok negeri.</p>
                    </div>
                </div>

                <div class="text-center mb-20">
                    <h3 class="serif text-4xl mb-12 italic">Kata Mereka</h3>
                    <div class="flex flex-wrap justify-center gap-6">
                        <div class="glass-card p-8 max-w-sm text-left relative">
                            <div class="flex text-amber-500 gap-1 mb-4"><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i></div>
                            <p class="lora italic text-white/70 mb-6 leading-relaxed">"Situs preloved paling rapi! Detail minus sangat membantu saya menentukan pilihan."</p>
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full bg-amber-900/40"></div>
                                <span class="text-[10px] font-bold uppercase tracking-widest text-white/30">Andi, Jakarta</span>
                            </div>
                        </div>
                        <div class="glass-card p-8 max-w-sm text-left relative">
                            <div class="flex text-amber-500 gap-1 mb-4"><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i></div>
                            <p class="lora italic text-white/70 mb-6 leading-relaxed">"Suasananya asik banget, berasa lagi di perpustakaan sungguhan. Sangat terpercaya."</p>
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full bg-blue-900/40"></div>
                                <span class="text-[10px] font-bold uppercase tracking-widest text-white/30">Maya, Yogyakarta</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="border-t border-white/5 pt-20 flex flex-col md:flex-row justify-between items-center gap-10 opacity-40 grayscale hover:grayscale-0 transition-all duration-700">
                    <div class="flex items-center gap-2"><i data-lucide="check-circle" class="w-4 h-4"></i> <span class="text-[10px] uppercase tracking-[0.3em] font-bold">Official Store</span></div>
                    <div class="flex items-center gap-2"><i data-lucide="truck" class="w-4 h-4"></i> <span class="text-[10px] uppercase tracking-[0.3em] font-bold">Fast Shipping</span></div>
                    <div class="flex items-center gap-2"><i data-lucide="lock" class="w-4 h-4"></i> <span class="text-[10px] uppercase tracking-[0.3em] font-bold">Secure Checkout</span></div>
                </div>
            `;
        }

        function openBook(id) {
            playSound('snd-open');
            const b = BOOKS_DB.find(x => x.id === id);
            const overlay = document.getElementById('modal-overlay');
            const container = document.getElementById('modal-container');
            
            overlay.classList.remove('hidden');
            container.innerHTML = `
                <div class="glass-card overflow-hidden flex flex-col md:flex-row shadow-2xl min-h-[500px]">
                    <div class="w-full md:w-1/2 relative group">
                        <img src="${b.img}" class="absolute inset-0 w-full h-full object-cover transition-all duration-700" alt="${b.title}">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
                        <div class="absolute bottom-8 left-8">
                             <span class="bg-amber-600 text-[10px] px-3 py-1 rounded-full font-bold uppercase tracking-widest mb-2 inline-block">Lokasi: ${b.address}</span>
                        </div>
                    </div>
                    <div class="w-full md:w-1/2 p-12 flex flex-col">
                        <div class="flex justify-between items-start mb-6">
                            <div>
                                <h2 class="serif text-4xl text-white mb-2 leading-tight">${b.title}</h2>
                                <p class="lora italic text-amber-500/70 text-lg">${b.author}</p>
                            </div>
                            <div class="text-right">
                                <span class="text-xs font-bold text-white/30 uppercase tracking-widest">${b.category}</span>
                            </div>
                        </div>

                        <div class="space-y-6 mb-10 overflow-y-auto max-h-[300px] pr-4">
                            <div>
                                <label class="text-[10px] uppercase font-bold text-amber-500/50 block mb-1">Kondisi Barang</label>
                                <p class="text-white/80 lora">${b.condition}</p>
                            </div>
                            <div>
                                <label class="text-[10px] uppercase font-bold text-amber-500/50 block mb-1">Detail Minus</label>
                                <p class="text-rose-300/80 lora italic">${b.minus}</p>
                            </div>
                            <div>
                                <label class="text-[10px] uppercase font-bold text-amber-500/50 block mb-1">Informasi Buku</label>
                                <p class="text-white/60 text-sm leading-relaxed">${b.desc}</p>
                            </div>
                        </div>

                        <div class="mt-auto pt-6 border-t border-white/10 flex items-center justify-between">
                            <span class="serif text-3xl text-white">Rp ${b.price.toLocaleString('id-ID')}</span>
                            <button onclick="addToCart(${b.id})" class="bg-amber-600 hover:bg-amber-500 text-white px-8 py-3 rounded-full font-bold uppercase text-[10px] tracking-[0.2em] transition-all shadow-lg shadow-amber-900/40">Adopsi Buku</button>
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        async function magicWrite() {
            const btn = document.getElementById('ai-magic-btn');
            const title = document.getElementById('in-title').value;
            const desc = document.getElementById('in-desc');
            if(!title) return;
            btn.disabled = true;
            btn.innerHTML = `<i data-lucide="loader-2" class="animate-spin w-4 h-4"></i>`;
            lucide.createIcons();
            const prompt = `Berikan deskripsi puitis sangat singkat untuk buku "${title}". Soroti keindahannya sebagai buku preloved berkualitas.`;
            const result = await callGemini(prompt, "Pustakawan AI Living Library.");
            desc.value = result;
            btn.disabled = false;
            btn.innerHTML = `<i data-lucide="sparkles" class="w-4 h-4"></i>`;
            lucide.createIcons();
        }

        async function callGemini(prompt, sys) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        systemInstruction: { parts: [{ text: sys }] }
                    })
                });
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "Maaf, sedang sibuk.";
            } catch { return "Koneksi AI terputus."; }
        }

        function renderSell() {
            const app = document.getElementById('app');
            app.innerHTML = `
                <div class="max-w-xl mx-auto glass-card p-12 fade-in">
                    <h2 class="serif text-4xl mb-4 italic">Titip Jual</h2>
                    <p class="text-sm text-white/40 mb-10 lora">Bagikan cerita Anda kepada pembaca baru.</p>
                    <div class="space-y-6">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-[9px] uppercase font-bold text-amber-500/50 block mb-1 tracking-widest">Judul</label>
                                <input id="in-title" class="w-full bg-white/5 border-b border-white/10 p-3 outline-none focus:border-amber-500 lora text-sm" placeholder="Contoh: Sang Pemimpi">
                            </div>
                            <div>
                                <label class="text-[9px] uppercase font-bold text-amber-500/50 block mb-1 tracking-widest">Kota Asal</label>
                                <input class="w-full bg-white/5 border-b border-white/10 p-3 outline-none focus:border-amber-500 lora text-sm" placeholder="Contoh: Malang">
                            </div>
                        </div>
                        <div>
                            <label class="text-[9px] uppercase font-bold text-amber-500/50 block mb-1 tracking-widest">Kondisi & Minus</label>
                            <input class="w-full bg-white/5 border-b border-white/10 p-3 outline-none focus:border-amber-500 lora text-sm" placeholder="Contoh: 95%, mulus">
                        </div>
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-amber-500/50 block mb-1 tracking-widest">Deskripsi Cerita</label>
                            <textarea id="in-desc" class="w-full bg-white/5 border border-white/10 p-4 h-32 rounded-xl outline-none focus:border-amber-500/30 lora text-sm" placeholder="Tuliskan alasan buku ini layak diadopsi..."></textarea>
                            <button id="ai-magic-btn" onclick="magicWrite()" class="absolute bottom-4 right-4 bg-amber-600/20 text-amber-400 p-2 rounded-lg hover:bg-amber-600 hover:text-white transition-all">
                                <i data-lucide="sparkles" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <button onclick="navigate('home')" class="w-full bg-amber-700 py-4 rounded-xl font-bold uppercase text-[10px] tracking-[0.3em] hover:bg-amber-600 transition-all shadow-xl shadow-amber-900/20">Kirim untuk Verifikasi</button>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        function renderCart() {
            const app = document.getElementById('app');
            if(cart.length === 0) {
                app.innerHTML = `<div class="text-center py-40 opacity-20 serif text-3xl italic">Tas adopsi kosong...</div>`;
                return;
            }
            const total = cart.reduce((s, i) => s + i.price, 0);
            app.innerHTML = `
                <div class="max-w-2xl mx-auto fade-in">
                    <h2 class="serif text-5xl mb-12 italic text-center">Buku Terpilih</h2>
                    <div class="space-y-4 mb-10">
                        ${cart.map((c, idx) => `
                            <div class="glass-card p-6 flex justify-between items-center">
                                <div class="flex items-center gap-6">
                                    <img src="${c.img}" class="w-16 h-20 object-cover rounded shadow-lg">
                                    <div>
                                        <h4 class="serif text-xl">${c.title}</h4>
                                        <p class="text-[10px] uppercase font-bold text-white/30 tracking-widest">${c.author}</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="serif text-lg">Rp ${c.price.toLocaleString('id-ID')}</p>
                                    <button onclick="removeFromCart(${idx})" class="text-[9px] font-bold text-rose-500/50 uppercase tracking-tighter hover:text-rose-400">Hapus</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="glass-card p-10 bg-white/5 border-amber-500/20 border">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-[10px] font-bold uppercase tracking-widest text-white/30 mb-1">Total Pembayaran</p>
                                <h3 class="serif text-4xl">Rp ${total.toLocaleString('id-ID')}</h3>
                            </div>
                            <button onclick="showQRIS(${total})" class="bg-white text-black px-12 py-4 rounded-xl font-bold uppercase text-[10px] tracking-widest hover:bg-amber-50 transition-all">Lanjut Pembayaran</button>
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        function showQRIS(amt) {
            playSound('snd-click');
            const container = document.getElementById('modal-container');
            document.getElementById('modal-overlay').classList.remove('hidden');
            container.innerHTML = `
                <div class="glass-card p-12 max-w-md mx-auto text-center">
                    <h3 class="serif text-3xl mb-8">QRIS Payment</h3>
                    <div class="bg-white p-6 rounded-2xl inline-block mb-8 relative">
                        <div class="w-48 h-48 bg-slate-100 flex flex-wrap border-2 border-black">
                            ${Array(64).fill(0).map(() => `<div class="w-1/8 h-1/8 ${Math.random() > 0.5 ? 'bg-black' : 'bg-transparent'}" style="width:12.5%; height:12.5%"></div>`).join('')}
                        </div>
                    </div>
                    <p class="text-xs font-bold text-white/30 uppercase mb-2 tracking-widest">Total Bayar</p>
                    <p class="serif text-4xl text-amber-500 mb-10">Rp ${amt.toLocaleString('id-ID')}</p>
                    <button onclick="confirmPay()" class="w-full bg-amber-600 py-4 rounded-xl font-bold uppercase text-[10px] tracking-widest shadow-xl">Konfirmasi</button>
                </div>
            `;
            lucide.createIcons();
        }

        function confirmPay() {
            const container = document.getElementById('modal-container');
            container.innerHTML = `
                <div class="glass-card p-16 max-w-md mx-auto text-center">
                    <div class="w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-8">
                        <i data-lucide="check" class="text-green-400 w-10 h-10"></i>
                    </div>
                    <h3 class="serif text-4xl mb-4">Berhasil</h3>
                    <p class="lora italic text-white/50 mb-10">Pembayaran telah kami terima. Buku segera meluncur!</p>
                    <button onclick="clearAll()" class="w-full bg-white text-black py-4 rounded-xl font-bold uppercase text-[10px] tracking-widest">Kembali</button>
                </div>
            `;
            lucide.createIcons();
        }

        function clearAll() { cart = []; updateBadge(); closeModal(); navigate('home'); }
        function addToCart(id) {
            playSound('snd-click');
            const b = BOOKS_DB.find(x => x.id === id);
            if(!cart.some(i => i.id === id)) cart.push(b);
            updateBadge();
            closeModal();
            navigate('cart');
        }
        function removeFromCart(idx) { cart.splice(idx, 1); updateBadge(); renderCart(); }
        function updateBadge() {
            const b = document.getElementById('cart-badge');
            b.innerText = cart.length;
            b.classList.toggle('hidden', cart.length === 0);
        }
        function closeModal() { document.getElementById('modal-overlay').classList.add('hidden'); }
        window.onload = () => navigate('home');

        window.addEventListener('scroll', () => {
            const nav = document.getElementById('main-nav');
            if(window.scrollY > 50) {
                nav.classList.add('bg-black/80', 'backdrop-blur-xl', 'py-4');
                nav.classList.remove('py-6');
            } else {
                nav.classList.remove('bg-black/80', 'backdrop-blur-xl', 'py-4');
                nav.classList.add('py-6');
            }
        });
    </script>
</body>
</html>